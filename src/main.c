/*----------------------------------------------------------------------------
 * CMSIS-RTOS 'main' function template
 *---------------------------------------------------------------------------*/

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>

#include "Board_Buttons.h"
#include "GLCD.h"
#include "KBD.h"
#include "LED.h"
#include "LPC17xx.h"
#include "AUDIO/usbdmain.h"
#include "photo_gallery.h"
#include "AUDIO/usb.h"
#include "AUDIO/usbcfg.h"
#include "AUDIO/usbhw.h"
#include "AUDIO/usbcore.h"
#include "AUDIO/usbaudio.h"
#include "cmsis_os.h"
#include "snake.h"
#include "gallery_images.h"
#include "tic_tac_toe.h" // ADD THIS LINE for the new game

// Font index 16x24
#define __FI 1

// Joystick Values

#define UP 8
#define DOWN 32
#define LEFT 64
#define RIGHT 16
#define NEUTRAL 0
#define PRESSED 1

// ARRAY SIZES
#define PHOTO_GALLERY_ARRAY_SIZE 4
#define MENU_ARRAY_SIZE 3
// FIX: Update GAME_CENTER_MENU_SIZE to 2 (Snake + Tic-Tac-Toe)
#define GAME_CENTER_MENU_SIZE 2 

// STATES
#define PHOTO_GALLERY 0
#define MP3_PLAYER 1
#define GAME_CENTER 2
#define HOME_SCREEN 3

#define SNAKE 4
// ADD THIS LINE
#define TIC_TAC_TOE 5 

// Global Variables used for flow control between states
int selector = 0;
int prev_direction, direction;


void LCD_Template() {
    // Clear graphical LCD display
    GLCD_Clear(White);

    // Set a Green background with White text fot the LCD display
    // Add the Headers from the lab manual

    GLCD_SetBackColor(Red);
    GLCD_SetTextColor(White);
    GLCD_DisplayString(0, 0, __FI, (unsigned char *)"COE718 Final Project");
	  GLCD_DisplayString(1, 0, __FI, (unsigned char *)"   Umair Irfan     ");
    GLCD_SetTextColor(White);
		GLCD_SetBackColor(Green);
	  //GLCD_DisplayString(2, 0, __FI, (unsigned char *)"  Joystick Control    ");
    GLCD_SetBackColor(White);
    GLCD_SetTextColor(Black);
}

int menu_selector(int selector, int joystick_value, int array_size) {
    if (joystick_value == UP) {
        if (selector == 0) {
            selector = array_size - 1;
        } else {
            selector--;
        }

    } else if (joystick_value == DOWN) {
        if (selector == array_size - 1) {
            selector = 0;
        } else {
            selector++;
        }
    }
    return selector;
}

int side_ways_selector(int selector, int joystick_value, int array_size) {
    if (joystick_value == LEFT) {
        if (selector == 0) {
            selector = array_size - 1;
        } else {
            selector--;
        }

    } else if (joystick_value == RIGHT) {
        if (selector == array_size - 1) {
            selector = 0;
        } else {
            selector++;
        }
    }
    return selector;
}
void screen_options_select(int selector, char *screen_options[],
                           int size_of_array, int start_row) {
    int i;
    for (i = 0; i < size_of_array; i++) {
        if (i == selector) {
            GLCD_SetBackColor(Green);
						GLCD_SetTextColor(Black);
        } else {
            GLCD_SetBackColor(White);
						GLCD_SetTextColor(Black);
        }
        GLCD_DisplayString(start_row + i, 0, __FI, (unsigned char *)screen_options[i]);
    }
		GLCD_SetBackColor(White);
		GLCD_SetTextColor(Black);
}

int home_screen_main(int previous_page, char *home_screen_options[]) {
    if (previous_page != HOME_SCREEN) {
        LCD_Template();
        selector = 0;
    }
    direction = get_button();
    if (prev_direction == NEUTRAL) {
        selector = menu_selector(selector, direction, MENU_ARRAY_SIZE);
        // FIX: Pass 6 as the starting row for the main menu options
        screen_options_select(selector, home_screen_options, MENU_ARRAY_SIZE, 6); 
    }
    prev_direction = direction;

    // button
    if (get_button() == PRESSED) {
        // Selector's value is equal to the page's number
        return selector;
    }
    return HOME_SCREEN;
}

int photo_gallery(int previous_page) {
    static int currently_displayed_image = -1;

    if (previous_page != PHOTO_GALLERY) {
        LCD_Template();
        selector = 0;
        currently_displayed_image = -1;
        
        GLCD_SetBackColor(White);
        GLCD_SetTextColor(Black);
        GLCD_DisplayString(9, 0, __FI, (unsigned char *)"L/R: Nav | DN: Exit");
    }

    direction = get_button();
    if (prev_direction == NEUTRAL) {
        selector = side_ways_selector(selector, direction, NUM_GALLERY_IMAGES);
    }
    prev_direction = direction;

    if (selector != currently_displayed_image) {
        // Clear the display area
        GLCD_SetBackColor(White);
        //GLCD_Bargraph(100, 70, 160, 141, White);

        // All images are 64x64, so we can center them consistently
        // X = (320 - 64) / 2 = 128 to center horizontally
        // Y = 80 to position nicely
        // All images are 141x160
				GLCD_Bitmap(90, 50, 141, 160, (unsigned char *)get_gallery_image(selector));

        
        currently_displayed_image = selector;
    }

    if (Buttons_GetState() || (get_button() == DOWN)) {
        return HOME_SCREEN;
    }
    
    return PHOTO_GALLERY;
}

static const unsigned char Ash_image_bitmap[64 * 64 * 2 + 1] =
("\354R\216c-[,Snc\317k\014[\354R\357sQ|\060|\317sQ|\061t\317kM[ncncMc\216kMc\252"
 "J\206!jBq\204\060|P|\060|\020|Q\204\360s\256k\004\021\343\020\004\021\307)\060|\060|\363"
 "\214\024\225Tl\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\313R-[-[,[,[,[\252J\014S\317k\357s\060|\317k\061|Q|\317kncM[,[,[-[\253J\206"
 ")IBQ|\020|\357s\020t\060|\060|\357s\257k\307)\004\021\004\021\004\021\014[\060|\221\204\363"
 "\224\322\214\365C\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\353R\014S,[mcMcmc\212B\216c\357s\317s\256k\020t\360s\317k\256kMc,[\256"
 "kMc\353R\347\061\350\071\222\204\020t\256k\357s\017t\020|\020|\020ti:\004\021\004\021\004"
 "\021$\021Q|\060t\262\204\322\214\060t\366#\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034ncM[-[nc\256k\256k\313J\257k\256k\317k\357sQ|\020"
 "t\257k\216k-[Mc\215k\014S\307)\350\061q\204\061|\357s\017t\357s\216k\317s\317"
 "k\252J\004\021$\021$\021\004\021\347\061\222\204\222\204\024\225\222|\317c\027\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034M[-[M[M[\216k"
 "mc,[\256k\317k\317k\061|\061t\357k\216c\216kmcmc\252J\307)(:\222\204\060|\020"
 "t\020|\357s\357s\317s\257k\221\214E\031$\021%\011$\021\004\021Mcq|\024\225\363\214"
 "\222\204\323C\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034,[Mc,[M[\357s,[\256k\317k\357sQ|\222\204Q|\317kmc\216k\215c\354R"
 "\307)\010:q|q|Q|\020t\020t\317k\257s\020|\262\224u\255\004\021$\021E\021$\021$\021\357"
 "s\363\214\024\225\363\224Qt\027\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034McmcM[\357smc\253J\316k\020|\060|q\204q\204\020|\317"
 "smc,[\014[(:IB\262\214q\204Q|\020tQ|\060tQ|\360sP\204\372\336\256s$\021$\021$\021"
 "$\021\246)\262\214\023\225\363\214\023\225\363S\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034mcmc\317kmc\014[\014[\357s\357"
 "s\060|q\204\060|\317k\256kmcM[\313JIB\263\214q\204Q|Q|\060|Q|Q|Q|Q|x\316\332"
 "\336E\031D\011$\021$\021$\021\354R\363\214\363\224\064\235\223|\027$\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\216c\357s"
 "\256knc-[\256k\020t\060|\060|Q\204\060|\256k\216k-[M[\313R\323\214Q|\060|\020t\061"
 "|Q|\222\204Q|\020t\326\265|\367T\255$\021$\021$\021\004\021\004\021\060t\024\225\363\214"
 "\263\204\026<\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034M[\216k\256k\216kmc\060|\357s\060|q\204\060|\020t\317k\317k"
 "\256c\257k\323\214\222\214\060|\357s\357s\061|\060|\020t\061|\064\245\\\357|\357"
 "\013[$\021D\021$\021\004\021\246)\363\224\024\205\226d\027,\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034m[\216c\256"
 "kMc\317k\317k\020tQ|\060|\017|\317s\357s\317k\020t\222\204\322\214P|P|\357s\317"
 "s\060|\020t\020tq\214[\357\234\367x\316$\021$\021E\021$\021E\021\256c\325l\067\064\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034,[mcnc\216c\060|\060|Q|Q\204\357s\020|\020t\020t\020t\317k"
 "q\204q\204P|\060|\017t\060|\317k\357s\060|\332\336\234\367|\367\363\234$\021E\021"
 "$\021E\021\214*VD\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\256k\216kmc\317k\060|Q"
 "|\060|\020|\017t\060|Q|\061|\060|\216cQ|\060|Q|P|Q\204\060|\020|\357s\366\275;\347"
 "|\357[\347\312R$\021%\021E\021\013\022\367\033\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\357s\317km[\017t\060|q\204\060|\020|\060tr|Q|Q\204\061t\354R\060|\060|\060"
 "|Q\204\262\214Q\204\060|\265\265|\357\067\306T\235\063\235\307)\004\021\004\021\311"
 "\021\326\033\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\020t\317k\060|"
 "\017tq\204Q\204\060|Q|r\204Q|r\204\216c\010\062M[Q|q\204\020t\020|P|q\204\225\255"
 ";\347\371\336\364\275\211B\004\021\004\021$\021$\021S\023\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\357s\357k\060|\060|\357s\020t\020|\061|Q|\317k\252"
 "B,[\020t\222\204\020t\060t\060t\020t\020t\363\224\332\336\372\336\331\336\032\347"
 "\023\235\004\021$\021E\021\210\011\367\033\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\357k\020t\020t\060t\020t\060t\061|Q|\357k\360sQ|q|q|\023\225\221"
 "\204\222\204P|\060|\060|\271\326;\347;\347\\\357|\367x\316$\021$\021e\011\361\022"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034X<X<\070\064\231D\231L\070,\271T\231D\231L\231LX\064X\064\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034Q|\357s\317s\317k\020tQ|\222\204"
 "Q|\221\204q\204q\204q\204P|\023\225P|\060|\060|q\204\271\316[\347\\\357|\357"
 "\235\367\235\367\372\336E\021%\021+\012\367\033\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\371\\\371d\032m:m\230L\231"
 "L:m:u\231L\331T\271L\331\\\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\060|Q|\060t\060|r\204\323\214\020l\262\214\322\214\262\214\262\214"
 "\222\204\322\214\322\214q\204Q|\222\204\231\316[\347\\\357|\357\235\367\235"
 "\367\235\367\372\336\206!NS\326\033\030\034\030\034\030\034\371l\373\235\333\225"
 "Z}\030\034\030\034\030\034\030\034\030\034\030\034\070,\372d\271Tx<\331T\231LX<\371\\\271"
 "T\231L\331T\231L\371d\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\222\204\323\214\024\225\363\224\363\224Q|\020t\024\235\363\224\323\214"
 "\222\204\222\204\322\214\020tQ|\060|x\316[\357[\357\\\357|\367|\367\234\367"
 ";\347\361\254\022\255Z\276\030\034\030\034\030\034\030\034X\064\373\235\070$\331d\373"
 "\235\271T\030\034\030\034\030\034\030\034\070,X\064x<\271T\231DxDx<\070$\271LxDX\064X"
 "<\271T\070\064\271T\231D\271Tx<x<\030\034\030\034\030\034\030\034\024\225\065\235\064\235"
 "\064\235\023\225q|\023\225\363\214\262\204\222\204\262\214\262\214\262\214\020"
 "|\357sX\306[\357[\357;\347\033\347;\347;\347\365\305I\203\350\243\255\254\331"
 "\245\030\034\030\034\030\034\030\034\030\034\230L\373\245\230T\070$\272\225\031m\030\034"
 "\030\034\030\034x<:m:m\231L\371\\\331\\\331\\\331\\Zu\032mZu\032e\231DX<\032m\032"
 "e\331\\\331\\\331\\\030\034\030\034\030\034\030\034\323\214\363\214\364\224\364\224"
 "\363\224\322\214\322\214\322\204\323\214\262\214\322\214\221\204\222\204\060"
 "|X\316|\357;\357\372\336w\316\365\275s\255ls\005Z\306z)\254\221\315X\205\030"
 "\034\030\034\030\034\030\034\030\034\030\034\070$\232\215\272\225\070,\272\225\271T\030"
 "\034\030\034X,X<\230D\331T\271T\371d\271T\070$\331\\\231Lx<xD\331\\\070$\331\\"
 "\231LyD\231L\371dX,\030\034\030\034\030\034\026,\027,\066D\325|\323\214\222\204\222"
 "\204\262\204\262\214\262\214\221\204q|\020tx\316|\367\\\357\372\336\264\255"
 "\355s\210J\345QEbej\245z\310\233\222\305\270T\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\230L\333\235z\205\333\225\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\067,\223lq"
 "tq|\262\214\222\204\222\204q\204q\204\230\316\234\367|\367:\347\324\265\011"
 "c\005Z\005Z\246r\010\213i\223I\213\007\203+s\367#\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\331d\274\306\071}\071u\070,X<\070$xD\030\034\070$\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\026\064Rl\222|\222\204\221"
 "\204Q|\262\214\331\326|\357|\367[\357\264\275\350r%b\347\202l\264\016\315\356"
 "\314\016\315\356\304\315\304k\264\017\214\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\331dz\205\373\235z\205\033\246\274\306\373\245z\205"
 "\033\246\375\316\373\245\333\225xL\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034V"
 "TQl\060t\060|T\245;\347|\357|\367\271\326\016\214fr\206r\211\223\315\304\261"
 "\325\261\335\261\335\321\335\361\335\261\335o\325-\315U\\\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\271\\\333\225\030\034\030\034\070$\030\034\070$\030"
 "\034\030\034\030\034\232\215\071}\070,\333\235\331\\z\205\272\225\031u\272\225\031"
 "u\230L\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034UT\363\224X\316|\367|\367\032\347\022\255FZ\307z(\213\312\243\315\274"
 "\221\325\261\325\321\335\023\346\063\336\022\346\362\345\321\335\260\335\362"
 "\244\030\034\030\034\030\034\030\034\030\034\030\034\030\034\331\\\333\235\030\034\030\034\030"
 "\034\232\215\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\333\235"
 "\033\246\030\034\033\246\333\235Z}\035\327[\256\333\225\333\225Z}X\064\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\032\266|\367[\357\325\305ks&"
 "Z(\213\211\233\312\243L\264/\315P\315\356\304k\264\013\254\013\254\352\243\013"
 "\254\255\304O\325O\315\027,\030\034\030\034\030\034\030\034\030\034X<\373\235\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\371lz\205X\064\030\034\070"
 "$[\256\070,\030\034\030\034\030\034xL\331d\030\034\030\034\271T\272\225X<\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034xL\027\306o\234I\203\247r\007\203\252\233"
 "\211\233\013\254\255\304\315\304\356\304l\274\312\243\251\243h\233H\233H\233"
 "K\264\354\314-\315\223\214\030\034\030\034\030\034\030\034\030\034\333\225X\064\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\331d\272\215"
 "\272\215\273\225\234\276\234\276\031uX<\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\063lj\213"
 "H\213\347\202H\223i\223\211\233k\274l\274k\264\016\305O\315P\315Q\315p\325"
 "p\335\356\314\356\314\217\325.\315\016\305\026L\030\034\030\034\030\034\030\034\273"
 "\225\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\070,\375\326Z}\232\215\272\225\333\235\272\225"
 "\232\215\031u\070,\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034R|\212\223(\223h\223\211\233\251\243\352\253K\264+\264\255\274/\315"
 "\357\304\317\264n\244M\244n\254\257\274\020\315p\325.\315\255\274q\234\030\034"
 "\030\034\030\034\030\034\272\225\030\034\030\034\030\034\030\034\030\034\030\034\030\034Z}\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034Z\205Z}\030\034\030\034\030"
 "\034\030\034X\064\331dxD\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034/\204\251\233h\233\352\253\012\254\312\243K\264\012\254*\254\013"
 "\244\016\224S\255\265\275\366\305\026\306\026\306\325\275\063\265\213\223\255"
 "\304K\264l\274\026T\030\034\030\034\030\034\332\225X<\030\034\030\034\030\034\030\034\030"
 "\034\030\034\273\225\030\024\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\027\034\354\213\012\254\311\243\012\254k"
 "\264\352\243\012\254\210\233\246r\006R\214\203o\244S\275\224\305S\265s\265\365"
 "\305\325\305\211R\207j\252\243+\264/\234\027\034\030\034\030\034\070,\373\245\230"
 "L\030\034\030\034\030\034\030\034\030\034\333\225\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\066LH\213L\264\011"
 "\254J\274\214\274K\264\352\253\347\202\007\203k\264/\315p\315O\315\017\305\316"
 "\274\255\274\256\274\216\264\214\274\352\243\246z\211\233\251\243\024\\\030"
 "\034\030\034\030\034\070,\232\215\333\235z\205\271\\\271T\232\215z\205\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034Vd\061\305+\264*\264K\264\214\274\255\274\214\274K\264'\213I\213\255\274"
 "/\315p\325q\325P\315l\264\312\233\013\244\060\305P\315K\264\346\202erH\223\017"
 "\214\030\034\030\034\030\034\030\034\030\034\030\034\231T:u\071u\230L\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\224"
 "\214\222\325O\325\213\304*\264\254\274\254\274\355\304\355\304\356\304K\264"
 "'\213\013\244p\325\323\335P\315\354\243\007\203'\213G\233\251\233\215\264+\254"
 "\306\202\347\202\012\254l\264\066L\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034Ud\357\304/\315\017\315O\325\352\253\355\304\314\304.\315"
 "o\325\260\335\220\335\355\304\311\243+\254\016\315\254\274K\264*\254\314\304"
 "\015\315\314\304*\264h\233'\223\254\274.\315\015\315\222\224\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034q\234\016\315\310\243\315\304"
 "o\325\012\254\015\315.\325N\325\320\335\022\346\022\346\022\346\217\335\213\274"
 "l\274o\325o\325o\325\023\346\022\336\361\335-\315\252\243/\315\362\345\361\335"
 "\261\335\020\265\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\027,"
 "-\254p\325\352\243\252\223\315\304\351\253\015\315.\325\261\335\321\335\064"
 "\346U\346\064\346\362\345\321\335o\325O\325/\325\322\335\225\356T\346\321\335"
 "\356\314\220\335\064\346U\356\062\346\361\345O\315\027$\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\066T\013\254\314\304\355\304l\264I\203\353\243\355"
 "\314o\325\220\335\362\335\362\345\023\346\023\346\362\345\321\335\261\335\220"
 "\335p\325P\325\023\346\362\345/\315p\325\261\335\261\335\362\345\362\345\362"
 "\345P\315t\033\367\033\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\067D\312\233"
 "m\264\351\243+\244\204A\013\254\315\304.\315o\325\220\335o\325\016\305\214\274"
 "K\264K\264\356\304O\315\356\304\017\315\221\335O\325\213\274\213\274*\254\255"
 "\274\060\315\220\325o\325\315\274\250\011\012\012\360\022\265\023\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\027\034k\203\350z\353\243\207b\244I\353\243\254\304\315\304"
 "\357\314K\254\353\233P\305\322\325\322\325O\325K\264K\264+\254\255\304\221"
 "\335\356\314h\223\013\244\016\305\222\315\222\315\013\234K\264L\254f\021\210\011"
 "\207\011\210\011m\012\224\023\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\367\033\021\023\013\022\214{N\244){\003!\244A\251"
 "\233\315\304\355\314\355\304*\254K\254\247Z\314\062\220C\021\245\350j){i\223"
 "/\315\261\335\255\274FZ\210RNK\015CJci\203L\264\251\223F\021E\021F\021F\021F\021"
 "F\021\216\012\367\033\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\265\023\013\012\250\021\250\021\210\031\204\061\003!\343\030\304Ai\223\315\304"
 "\314\304\015\315\255\274\214\264\016\305\216\254\353\223){\247j\250j)\213\316"
 "\304\220\325\016\305)\213gZFbi\213l\264K\264\251\233\010{E\021%\021%\021%\021%\021"
 "%\021&\021\353\021\327\033\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\251\011\210\021g\021\207\021\206!D)\003!\003!\244AI\213\216\274\213\274\254"
 "\304\355\314\315\264\255\254K\244I\203\307j\206bi\213\215\274P\325o\325O\325"
 "\315\304\251\233fjEZ\307jH\213\007\203gZ$\021$\031%\031\005\021\004\031\004\031\004\021%\021"
 "M\022\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034f\021g\021F\021"
 "&\021%\031\003!\003\031\343\030c\061\247j,\254K\254\213\264O\325\220\325\020\275\357"
 "\304\356\304/\315\261\335\023\346\023\346\262\335\260\335\260\335\321\335\321"
 "\335\260\335\355\314J\264\251\243\007\203\245A\344\020\344\030\004\031\004\021\004\021"
 "\344\020\344\030\344\020\344\020\225\023\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034F\021E\021%\021%\021\344\030#!\343\030\303\030\003!\345I\010\203\252\243"
 "\352\243\255\274\262\335\363\335\362\345\362\345\023\346T\346T\356U\346\064"
 "\346\361\335\022\346\063\346T\346\322\335\016\315k\274i\233fjC\061\343\030\343"
 "\030\344\030\344\020\344\020\344\020\344\020\343\020\303\020S\023\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034%\021%\021\005\021\005\021\344\020\343\030\343\030\303"
 "\030\343\030C\061Eb(\213\311\243K\264\016\305P\315\322\335\321\335\322\335\220"
 "\325\220\325\261\335\261\335\220\335\261\335\260\325p\325\255\304*\264\312"
 "\243\307\202\304Q\003!\343\020\343\030\343\030\343\020\343\020\343\020\303\020\303"
 "\020\344\020\266\023\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\004\021"
 "\005\021\005\021\005\021\343\020\343\030\343\030\302\030\303\030\003!d\071Fb\007\203\311\233"
 "+\254\214\274\315\304\016\315\016\315\356\314\016\315\356\304\315\304\315\304"
 "\356\304\315\304k\264\251\243H\223\307z\005Zc\071\003!\343\030\343\030\343\030\303"
 "\020\303\020\303\020\303\020\303\020\257\022\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\004\021\004\021\005\021\344\020\303\020\303\020\343\020\303\030\242"
 "\020\303\030#!\244\071Eb\346\202'\213\251\233\012\254\013\254\013\254+\264l\274"
 "K\264\012\264\352\253\312\253\251\243H\223\347\202\206j\005Z\204A#)\343\030\343"
 "\030\343\030\343\030\303\020\303\020\303\020\303\020m\022\027\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\004\021\344\020\344\020\303\020\303\020\343"
 "\020\343\020\303\020\302\020\302\020\343\030\003!\204\071%Z\206j\306zG\223i\233H\223"
 "h\233\211\233h\233h\233h\223\007\213\206rEj\344Q\204\071\204\061C)\003!\343\030\343"
 "\030\343\030\303\020\303\020\343\020\005\021\021\023\027\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\343\020\344\020\303\020\303\020\303\020\303"
 "\020\303\020\303\020\303\020\242\020\302\030\302\030\003!C\061\305I\344QEbEjEjEjEjE"
 "b%b\345Y\344Q\244I\204A#)\003)#!\343\030\343\030\343\030\343\030\343\030\303\020\344"
 "\020m\032\326\033\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\303\020\303\020\303\020\303\020\303\020\303\020\303\020\303\020\303"
 "\020\303\020\242\020\302\030\302\030\343\030\003!#)C\061C\061C\061C\061d\071c\071C\061#)"
 "#)\003!\003!\343\040\343\030\343\030\343\030\343\030\343\030\343\030E\031\256*\265#\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\013\032\343\020\303\020\303\020\303\020\303\020\303\020\303\020\303\020\343"
 "\020\343\030\303\030\302\030\302\030\302\030\343\030\343\030\342\030\343\030\343\030"
 "\343\030\343\030\343\030\343\030\343\030\343\030\343\030\343\030\343\030\343\030\343"
 "\030\004\031k\062R+\366#\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034t\033\256\032\310\031\343"
 "\020\303\020\303\020\303\020\303\020\343\030\343\030\343\030\343\030\343\030\343\030"
 "\343\030\003\031\343\030\343\030\343\030\343\030\343\030\343\030\343\030\343\030\343\030"
 "\343\030\343\030\206)i:I:I\062\224\033\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\027\034\326#s#j*\010*\010\062\307)\206!E!$\031\343\030\343\030\343"
 "\030\343\030\303\030\303\030\343\030\343\030\004\031e)\347\061I:i:j:j:(\062$\031\004\031"
 "J\032\367\033\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\027\034\012\012\011\012\310\021\307!\347)I\062I:i:i:\212:j:\212:j:\313B\212:I"
 "\062(\062\347)e!\004\031\343\020\343\020\343\020\004\031J\"\216\012\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034K\012\351\011*\012"
 "K\012*\012\247\021\004\021\343\020\003\031\343\030\343\030\343\030\343\030\343\030\004\031\343"
 "\030\343\030\343\030\343\030\343\030\343\030\343\030\343\030*\"\310\011\062\023\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\216"
 "\022\350\011\350\011\351\011\351\011*\022*\012\310\021$\031\004\031\004\031\343\030\343\030"
 "\003\031\343\030\343\020\343\020\343\020\343\030\343\030\343\030\004\031J\"\350\021g\011"
 "\326\023\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\317\012\250\011\247\011\207\011\207\011\310\011\350\011*\012K\022\011\022"
 "f\021\004\031\004\031\343\020\343\030\343\030\343\030\343\020\343\030\343\030\004\021j*)\032"
 "%\011\217\022\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\265\023\250\011%\021E\011f\011\207\011\247\021\310\011\351\011"
 "J\012k\022\011\022\207\021E\021\004\031\343\030\343\030\343\030\004\021E\021)\032J\032E\021\005"
 "\021\265\023\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\265\023\251\021\004\021%\021E\021f\021\207\021\247\011\310"
 "\011\012\012K\012*\022\350\021\247\011\207\011\207\011\247\021\247\021\310\021*\022f\021"
 "\344\020\217\022\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\326\033,\022%\021%\021E\011E\021F\021"
 "\206\011\247\011\011\022J\022*\022\310\021\307\021\247\021\307\021\247\011\011\012F\021"
 "\344\020h\021\367\033\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\027\034\021\023g\021%\021%\021"
 "%\021%\021E\011\206\011\011\022J\022\351\011\307\021\307\021\307\021\350\011\207\011\004"
 "\021\344\020S\023\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034"
 "\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030"
 "\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034\030\034");
void DisplayAsh() { // Pokeball
    GLCD_Bitmap(110, 60, 64, 64, (unsigned char *)Ash_image_bitmap);
}
int mp3_music_player() {
    LCD_Template();
    GLCD_DisplayString(6, 2, __FI, (unsigned char *)"MUSIC STREAMING!");
	  GLCD_DisplayString(7, 2, __FI, (unsigned char *)" Playing Now. . . ");
	  GLCD_DisplayString(8, 2, __FI, (unsigned char *) "My Way");
    //DisplayPokeball();
		DisplayAsh();
	  stream_music();
    return HOME_SCREEN;
}

// FIX: Updated game_center to include TIC_TAC_TOE option
int game_center(int previous_page) {
    // Menu options including the exit option
    // FIX: Added Tic-Tac-Toe as the second game option
    char *game_center_options[] = {"1. SNAKE", "2. TIC-TAC-TOE", "3. MAIN MENU"};
    
    if (previous_page != GAME_CENTER) {
        LCD_Template(); 
        GLCD_SetTextColor(Black);
        GLCD_DisplayString(4, 0, __FI, (unsigned char *)"  [GAME CENTER MENU]"); 
        selector = 0; // Reset selector for this menu
    }
    
    direction = get_button();
    if (prev_direction == NEUTRAL) {
        // We now have 2 games + 1 back option = 3 total options
        selector = menu_selector(selector, direction, GAME_CENTER_MENU_SIZE + 1); 
        // Start options at row 6
        screen_options_select(selector, game_center_options, GAME_CENTER_MENU_SIZE + 1, 6);
    }
    prev_direction = direction;
    
    if (get_button() == PRESSED) {
        if (selector == 0) { 
            return SNAKE; // Start Snake Game
        } else if (selector == 1) { // Selector 1 is now Tic-Tac-Toe
            return TIC_TAC_TOE; // Start Tic-Tac-Toe Game
        } else {
            return HOME_SCREEN; // Go back to the main menu
        }
    }
    return GAME_CENTER; // Stay in game center menu
}


void pre_game_screen() {
    GLCD_Clear(White);
    GLCD_SetBackColor(DarkGreen);
    GLCD_SetTextColor(White);
    GLCD_DisplayString(4, 0, __FI, (unsigned char *)"--- S N A K E ---");
    GLCD_DisplayString(5, 0, __FI, (unsigned char *)"Use JOYSTICK to move!");
    GLCD_DisplayString(6, 0, __FI, (unsigned char *)"Eat Food to GROW!");
    GLCD_DisplayString(7, 0, __FI, (unsigned char *)"Press ENTER");
    GLCD_DisplayString(8, 0, __FI, (unsigned char *)"     TO START");
    GLCD_SetTextColor(Blue);
}

int post_game_screen(int score, int game) {
    char score_str[5];
    snprintf(score_str, 5, "%d", score);
    GLCD_Clear(White);
    GLCD_SetBackColor(White);
    GLCD_SetTextColor(Red);
    GLCD_DisplayString(2, 0, __FI, (unsigned char *)"- YOU LOSE -");
    GLCD_SetTextColor(Black);
    GLCD_DisplayString(4, 0, __FI, (unsigned char *)"FINAL SCORE:");
    GLCD_DisplayString(4, 13, __FI, (unsigned char *)score_str);
    GLCD_DisplayString(6, 0, __FI, (unsigned char *)"OPTIONS:");
    GLCD_DisplayString(7, 0, __FI, (unsigned char *)"  - UP -> RESTART");
    GLCD_DisplayString(8, 0, __FI, (unsigned char *)"  - DOWN -> EXIT"); // Clarified instruction
    GLCD_SetTextColor(Blue);
    while (1) {
        if (get_button() == KBD_UP) {
            return game; // Restart the current game
        } else if (get_button() == DOWN) {
            // FIX: Returns to the GAME_CENTER menu, breaking the infinite loop.
            return GAME_CENTER; 
        }
    }
}
int snake_main(int previous_page) {
    int game_score;

    if (previous_page != SNAKE) {
        pre_game_screen();
    }
    // Wait specifically for the ENTER/PRESSED button to start the game
    while (get_button() != PRESSED); 
    
    GLCD_Clear(White);
    GLCD_SetBackColor(White);
    // snake_game() is where the game loop runs
    game_score = snake_game();
    return post_game_screen(game_score, SNAKE);
}

// FIX: New Launcher Function for Tic-Tac-Toe (Add this before main)
int tic_tac_toe_main_wrapper(int previous_page) {
    // Run the game loop. It handles its own setup and teardown.
    // The loop will only return when the user chooses 'EXIT'.
    tic_tac_toe_game();
    
    // When the game returns, we go back to the game center menu
    return GAME_CENTER;
}

int main(void) {
    int page_to_show = HOME_SCREEN;
    int new_page = HOME_SCREEN;
    int previous_page = HOME_SCREEN;

    char *home_screen_options[] = {"Photo Gallery", "MP3 Player", "Game Center"};
    // FIX: Removed unused local variable char *game_center_options[] = {"ASCII SNAKE GAME"};
    
    LED_Init();
    GLCD_Init();
    LCD_Template();
    KBD_Init();
    Buttons_Initialize();

    for (;;) {
        previous_page = page_to_show;  // Update previous_page before
                                       // page_to_show is updated
        page_to_show = new_page;
        switch (page_to_show) {
            case HOME_SCREEN:
                new_page = home_screen_main(previous_page, home_screen_options);
                break;
            case PHOTO_GALLERY:
                new_page = photo_gallery(previous_page);
                break;
            case MP3_PLAYER:
                // always returns to home screen
                new_page = mp3_music_player();
                break;
            case GAME_CENTER:
                new_page = game_center(previous_page);
                break;
			case SNAKE:
				new_page = snake_main(previous_page);
				break;
            // ADD THIS NEW CASE
            case TIC_TAC_TOE:
                new_page = tic_tac_toe_main_wrapper(previous_page);
                break;
        }
    }
}
